
<% orgid = params[:org] %>
<% user_type = params[:user] %>

<% org = Org.where(:id => orgid).first %>

<% status = "own" %>

<div class="signup-box">
  <h1 class="cnt-txt" id="fadeUsr1"></h1><br /> 
  <h2 class="cnt-txt" id="fadeUsr2"></h2><br /> 
  <h2 class="cnt-txt" id="fadeUsr3"></h2><br /><br />
  <!-- Button trigger modal -->
      <%= link_to 'continue', '#', data: {toggle: 'modal', target: '#regOrg'}, class: 'btn btn-success' %>
</div>

<!-- Modal For New Org Creation <h6 class="cnt-txt">if you'd like to join an existing space that someone has invited you to, please click here.</h6>-->
<div class="modal fade" id="regOrg" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">Ã—</span>
        </button>
      </div>
      <div class="modal-body cnt-txt">
        <h3>create new user</h3><br /><br />
        <h5>enter your details below, we'll set</h5>
        <h5>you up as the owner for <%= org.name %>.</h5>
        <br />
          
          <%= simple_form_for(resource, as: resource_name, url:registration_path(resource_name)) do |f| %>
          <%= f.error_notification %>
            <div class="field cnt-txt">
              <%= f.input :first_name, autofocus: true, autocomplete: "off", placeholder: "Sam", input_html: { id: "firstname" } %>
            </div>

            <div class="field">
              <%= f.input :last_name, autofocus: true, autocomplete: "off", placeholder: "Smith" %>
            </div>

            <div class="field">
              <%= f.input :email, autofocus: true, autocomplete: "email", placeholder: "sam.smith@company.com" %>
            </div><br />

            <div class="field">
              <%= f.hidden_field :org_id, value: orgid, autocomplete: "off" %>
              <%= f.hidden_field :status, value: status, autocomplete: "off" %>
            </div>
            <br />
            <div class="field">
              <%= f.input :password, autocomplete: "off", placeholder: "******" %>
              <%= f.input :password_confirmation, autocomplete: "off", placeholder: "******" %>
            </div>

            <br /><br />

            <div class="actions">
              <%= f.submit 'continue', class: 'btn btn-success', id: 'btnCreateUser' %>
            </div>
          <% end %>

      </div>
      <div class="modal-footer">
      </div>
    </div>
  </div>
</div>




<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

<script>

  $("#btnCreateUser").on('click', function(){
    var firstName = document.getElementById('firstname').value

    if( firstName == "" ) {
      alert("you'll need to enter your first name to create an account")
      return false;
    } else {
      return true;
    }
  });

</script>

<script>
  $(document).on('turbolinks:load', function() {

    var populateText = function() {
      var stage = $(".stage").text()
      if (stage != null) {
        $('#fadeUsr1').append($('<div>fantastic, almost done!</div>').hide().fadeIn(2000));
        $('#fadeUsr2').append($('<div>now let\'s set you up as the owner for <%= org.name %>\'s new space</div>').hide().fadeIn(2000));
        $('#fadeUsr3').append($('<div>click continue to create your account</div>').hide().fadeIn(2000));
      }
    };
    
    $(populateText);

  });

</script>